[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
                                                                                                                   
{'loss': 2.31, 'grad_norm': 1.330902338027954, 'learning_rate': 9.615384615384617e-07, 'epoch': 0.02}
{'loss': 2.2993, 'grad_norm': 1.4837346076965332, 'learning_rate': 2.02991452991453e-06, 'epoch': 0.04}
{'loss': 2.3124, 'grad_norm': 1.9378761053085327, 'learning_rate': 3.0982905982905984e-06, 'epoch': 0.06}
{'loss': 2.3026, 'grad_norm': 1.2269058227539062, 'learning_rate': 4.166666666666667e-06, 'epoch': 0.09}
{'loss': 2.3028, 'grad_norm': 1.2905266284942627, 'learning_rate': 5.235042735042736e-06, 'epoch': 0.11}
{'loss': 2.2976, 'grad_norm': 1.4334115982055664, 'learning_rate': 6.303418803418804e-06, 'epoch': 0.13}
{'loss': 2.2982, 'grad_norm': 1.818701148033142, 'learning_rate': 7.371794871794873e-06, 'epoch': 0.15}
{'loss': 2.2939, 'grad_norm': 1.4171611070632935, 'learning_rate': 8.44017094017094e-06, 'epoch': 0.17}
{'loss': 2.2819, 'grad_norm': 1.346922516822815, 'learning_rate': 9.508547008547009e-06, 'epoch': 0.19}
{'loss': 2.283, 'grad_norm': 1.4773129224777222, 'learning_rate': 1.0576923076923077e-05, 'epoch': 0.21}
{'loss': 2.2775, 'grad_norm': 1.9670988321304321, 'learning_rate': 1.1645299145299147e-05, 'epoch': 0.23}
{'loss': 2.2715, 'grad_norm': 1.5069499015808105, 'learning_rate': 1.2713675213675213e-05, 'epoch': 0.26}
{'loss': 2.2633, 'grad_norm': 1.3038090467453003, 'learning_rate': 1.3782051282051284e-05, 'epoch': 0.28}
{'loss': 2.2541, 'grad_norm': 1.6007684469223022, 'learning_rate': 1.485042735042735e-05, 'epoch': 0.3}
{'loss': 2.2474, 'grad_norm': 1.7869137525558472, 'learning_rate': 1.591880341880342e-05, 'epoch': 0.32}
{'loss': 2.235, 'grad_norm': 1.8877596855163574, 'learning_rate': 1.698717948717949e-05, 'epoch': 0.34}
{'loss': 2.2284, 'grad_norm': 1.6247774362564087, 'learning_rate': 1.8055555555555555e-05, 'epoch': 0.36}
{'loss': 2.2225, 'grad_norm': 1.4928134679794312, 'learning_rate': 1.9123931623931624e-05, 'epoch': 0.38}
{'loss': 2.2086, 'grad_norm': 1.8314669132232666, 'learning_rate': 2.0192307692307694e-05, 'epoch': 0.41}
{'loss': 2.1979, 'grad_norm': 1.3701144456863403, 'learning_rate': 2.126068376068376e-05, 'epoch': 0.43}
{'loss': 2.1851, 'grad_norm': 1.5392628908157349, 'learning_rate': 2.232905982905983e-05, 'epoch': 0.45}
{'loss': 2.1765, 'grad_norm': 1.558110237121582, 'learning_rate': 2.33974358974359e-05, 'epoch': 0.47}
{'loss': 2.17, 'grad_norm': 1.3338959217071533, 'learning_rate': 2.4465811965811966e-05, 'epoch': 0.49}
{'loss': 2.1511, 'grad_norm': 1.3700346946716309, 'learning_rate': 2.5534188034188033e-05, 'epoch': 0.51}
{'loss': 2.1432, 'grad_norm': 1.4401116371154785, 'learning_rate': 2.6602564102564102e-05, 'epoch': 0.53}
{'loss': 2.1225, 'grad_norm': 1.8275272846221924, 'learning_rate': 2.7670940170940176e-05, 'epoch': 0.55}
{'loss': 2.1145, 'grad_norm': 1.5260847806930542, 'learning_rate': 2.873931623931624e-05, 'epoch': 0.58}
{'loss': 2.0908, 'grad_norm': 1.4809569120407104, 'learning_rate': 2.9807692307692308e-05, 'epoch': 0.6}
{'loss': 2.0759, 'grad_norm': 1.6406915187835693, 'learning_rate': 3.087606837606838e-05, 'epoch': 0.62}
{'loss': 2.0565, 'grad_norm': 1.905380129814148, 'learning_rate': 3.194444444444444e-05, 'epoch': 0.64}
{'loss': 2.0435, 'grad_norm': 1.5265376567840576, 'learning_rate': 3.301282051282051e-05, 'epoch': 0.66}
{'loss': 2.0317, 'grad_norm': 1.8879146575927734, 'learning_rate': 3.408119658119659e-05, 'epoch': 0.68}
{'loss': 2.0134, 'grad_norm': 1.482924461364746, 'learning_rate': 3.514957264957265e-05, 'epoch': 0.7}
{'loss': 1.9792, 'grad_norm': 1.3653899431228638, 'learning_rate': 3.621794871794872e-05, 'epoch': 0.73}
{'loss': 1.979, 'grad_norm': 1.4226125478744507, 'learning_rate': 3.728632478632479e-05, 'epoch': 0.75}
{'loss': 1.9523, 'grad_norm': 1.3706998825073242, 'learning_rate': 3.835470085470086e-05, 'epoch': 0.77}
{'loss': 1.9363, 'grad_norm': 1.791931390762329, 'learning_rate': 3.942307692307692e-05, 'epoch': 0.79}
{'loss': 1.9172, 'grad_norm': 1.3721119165420532, 'learning_rate': 4.049145299145299e-05, 'epoch': 0.81}
{'loss': 1.8889, 'grad_norm': 1.6502115726470947, 'learning_rate': 4.155982905982906e-05, 'epoch': 0.83}
{'loss': 1.8773, 'grad_norm': 1.6309382915496826, 'learning_rate': 4.262820512820513e-05, 'epoch': 0.85}
{'loss': 1.849, 'grad_norm': 1.7372974157333374, 'learning_rate': 4.36965811965812e-05, 'epoch': 0.87}
{'loss': 1.8139, 'grad_norm': 1.362518548965454, 'learning_rate': 4.476495726495727e-05, 'epoch': 0.9}
{'loss': 1.804, 'grad_norm': 1.576303243637085, 'learning_rate': 4.5833333333333334e-05, 'epoch': 0.92}
{'loss': 1.7841, 'grad_norm': 1.2622816562652588, 'learning_rate': 4.6901709401709404e-05, 'epoch': 0.94}
{'loss': 1.7429, 'grad_norm': 1.5591990947723389, 'learning_rate': 4.797008547008547e-05, 'epoch': 0.96}
{'loss': 1.7239, 'grad_norm': 1.4617294073104858, 'learning_rate': 4.9038461538461536e-05, 'epoch': 0.98}
                                                                                                                   
===== Validation Example ===============
sample 7270
answer: 1
pred: 1

sample 860
answer: 6
pred: 6

sample 5390
answer: 2
pred: 0

sample 5191
answer: 4
pred: 4

sample 5734
answer: 3
pred: 9

=======================================
{'eval_loss': 1.6728718280792236, 'eval_accuracy': 0.7606, 'eval_f1_score': 0.744732133446014, 'eval_precision': 0.7948883703247023, 'eval_recall': 0.7528405548646618, 'eval_runtime': 1.7854, 'eval_samples_per_second': 5600.872, 'eval_steps_per_second': 175.307, 'epoch': 1.0}
{'loss': 1.6466, 'grad_norm': 1.5472503900527954, 'learning_rate': 4.998812915479583e-05, 'epoch': 1.0}
{'loss': 1.6927, 'grad_norm': 1.5789453983306885, 'learning_rate': 4.986942070275404e-05, 'epoch': 1.02}
{'loss': 1.6465, 'grad_norm': 1.5801891088485718, 'learning_rate': 4.9750712250712256e-05, 'epoch': 1.04}
{'loss': 1.615, 'grad_norm': 1.6705048084259033, 'learning_rate': 4.9632003798670466e-05, 'epoch': 1.07}
{'loss': 1.5843, 'grad_norm': 1.6372140645980835, 'learning_rate': 4.951329534662868e-05, 'epoch': 1.09}
{'loss': 1.5666, 'grad_norm': 1.9491782188415527, 'learning_rate': 4.93945868945869e-05, 'epoch': 1.11}
{'loss': 1.5436, 'grad_norm': 1.6132080554962158, 'learning_rate': 4.927587844254511e-05, 'epoch': 1.13}
{'loss': 1.5105, 'grad_norm': 2.000258445739746, 'learning_rate': 4.9157169990503326e-05, 'epoch': 1.15}
{'loss': 1.4803, 'grad_norm': 1.6210784912109375, 'learning_rate': 4.9038461538461536e-05, 'epoch': 1.17}
{'loss': 1.4574, 'grad_norm': 1.3980778455734253, 'learning_rate': 4.891975308641975e-05, 'epoch': 1.19}
{'loss': 1.4468, 'grad_norm': 1.7178001403808594, 'learning_rate': 4.880104463437797e-05, 'epoch': 1.22}
{'loss': 1.3991, 'grad_norm': 1.5654792785644531, 'learning_rate': 4.8682336182336186e-05, 'epoch': 1.24}
{'loss': 1.4101, 'grad_norm': 1.7530255317687988, 'learning_rate': 4.8563627730294396e-05, 'epoch': 1.26}
{'loss': 1.3711, 'grad_norm': 1.4846607446670532, 'learning_rate': 4.844491927825261e-05, 'epoch': 1.28}
{'loss': 1.3382, 'grad_norm': 1.6891582012176514, 'learning_rate': 4.832621082621083e-05, 'epoch': 1.3}
{'loss': 1.3022, 'grad_norm': 1.3988268375396729, 'learning_rate': 4.8207502374169047e-05, 'epoch': 1.32}
{'loss': 1.3077, 'grad_norm': 1.590384602546692, 'learning_rate': 4.8088793922127257e-05, 'epoch': 1.34}
{'loss': 1.309, 'grad_norm': 1.4712245464324951, 'learning_rate': 4.797008547008547e-05, 'epoch': 1.36}
{'loss': 1.2553, 'grad_norm': 1.535343885421753, 'learning_rate': 4.785137701804368e-05, 'epoch': 1.39}
{'loss': 1.2078, 'grad_norm': 1.5197463035583496, 'learning_rate': 4.773266856600191e-05, 'epoch': 1.41}
{'loss': 1.2114, 'grad_norm': 1.3796504735946655, 'learning_rate': 4.761396011396012e-05, 'epoch': 1.43}
{'loss': 1.2267, 'grad_norm': 1.6549969911575317, 'learning_rate': 4.7495251661918333e-05, 'epoch': 1.45}
{'loss': 1.1732, 'grad_norm': 1.625015377998352, 'learning_rate': 4.7376543209876543e-05, 'epoch': 1.47}
{'loss': 1.1461, 'grad_norm': 1.4890397787094116, 'learning_rate': 4.725783475783476e-05, 'epoch': 1.49}
{'loss': 1.1389, 'grad_norm': 1.2206177711486816, 'learning_rate': 4.713912630579298e-05, 'epoch': 1.51}
{'loss': 1.1241, 'grad_norm': 1.4283207654953003, 'learning_rate': 4.7020417853751194e-05, 'epoch': 1.54}
{'loss': 1.0863, 'grad_norm': 1.4318420886993408, 'learning_rate': 4.6901709401709404e-05, 'epoch': 1.56}
{'loss': 1.0554, 'grad_norm': 1.3732253313064575, 'learning_rate': 4.6783000949667614e-05, 'epoch': 1.58}
{'loss': 1.0486, 'grad_norm': 1.3617721796035767, 'learning_rate': 4.666429249762583e-05, 'epoch': 1.6}
{'loss': 1.0533, 'grad_norm': 1.4437330961227417, 'learning_rate': 4.654558404558405e-05, 'epoch': 1.62}
{'loss': 1.017, 'grad_norm': 1.367530345916748, 'learning_rate': 4.6426875593542264e-05, 'epoch': 1.64}
{'loss': 0.9925, 'grad_norm': 1.46662175655365, 'learning_rate': 4.6308167141500474e-05, 'epoch': 1.66}
{'loss': 0.9974, 'grad_norm': 1.530680537223816, 'learning_rate': 4.618945868945869e-05, 'epoch': 1.68}
{'loss': 0.9999, 'grad_norm': 1.7340450286865234, 'learning_rate': 4.607075023741691e-05, 'epoch': 1.71}
{'loss': 0.9683, 'grad_norm': 1.3429155349731445, 'learning_rate': 4.5952041785375124e-05, 'epoch': 1.73}
{'loss': 0.9535, 'grad_norm': 1.5257978439331055, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.75}
{'loss': 0.9221, 'grad_norm': 1.2433183193206787, 'learning_rate': 4.571462488129155e-05, 'epoch': 1.77}
{'loss': 0.9099, 'grad_norm': 1.3746304512023926, 'learning_rate': 4.559591642924976e-05, 'epoch': 1.79}
{'loss': 0.905, 'grad_norm': 1.5386055707931519, 'learning_rate': 4.5477207977207984e-05, 'epoch': 1.81}
{'loss': 0.8946, 'grad_norm': 1.128398060798645, 'learning_rate': 4.5358499525166194e-05, 'epoch': 1.83}
{'loss': 0.8814, 'grad_norm': 1.3248144388198853, 'learning_rate': 4.523979107312441e-05, 'epoch': 1.86}
{'loss': 0.877, 'grad_norm': 1.2502648830413818, 'learning_rate': 4.512108262108262e-05, 'epoch': 1.88}
{'loss': 0.8699, 'grad_norm': 1.3267321586608887, 'learning_rate': 4.500237416904084e-05, 'epoch': 1.9}
{'loss': 0.8493, 'grad_norm': 1.3349705934524536, 'learning_rate': 4.4883665716999054e-05, 'epoch': 1.92}
{'loss': 0.8433, 'grad_norm': 1.3128337860107422, 'learning_rate': 4.476495726495727e-05, 'epoch': 1.94}
{'loss': 0.8208, 'grad_norm': 1.1111217737197876, 'learning_rate': 4.464624881291548e-05, 'epoch': 1.96}
{'loss': 0.8145, 'grad_norm': 1.2982759475708008, 'learning_rate': 4.45275403608737e-05, 'epoch': 1.98}
===== Validation Example ===============
sample 6265
answer: 4
pred: 4

sample 466
answer: 8
pred: 8

sample 4426
answer: 9
pred: 9

sample 5578
answer: 8
pred: 8

sample 8322
answer: 9
pred: 9

=======================================
{'eval_loss': 0.7771974802017212, 'eval_accuracy': 0.8554, 'eval_f1_score': 0.8533944936772629, 'eval_precision': 0.8587115993182974, 'eval_recall': 0.8526066708322411, 'eval_runtime': 2.0, 'eval_samples_per_second': 5000.106, 'eval_steps_per_second': 156.503, 'epoch': 2.0}
{'loss': 0.8053, 'grad_norm': 1.3465980291366577, 'learning_rate': 4.440883190883191e-05, 'epoch': 2.0}
{'loss': 0.7936, 'grad_norm': 1.1352208852767944, 'learning_rate': 4.429012345679013e-05, 'epoch': 2.03}
{'loss': 0.8064, 'grad_norm': 1.0428235530853271, 'learning_rate': 4.417141500474834e-05, 'epoch': 2.05}
{'loss': 0.7773, 'grad_norm': 1.3865331411361694, 'learning_rate': 4.405270655270656e-05, 'epoch': 2.07}
{'loss': 0.7686, 'grad_norm': 1.2861461639404297, 'learning_rate': 4.393399810066477e-05, 'epoch': 2.09}
{'loss': 0.7695, 'grad_norm': 1.3490352630615234, 'learning_rate': 4.3815289648622984e-05, 'epoch': 2.11}
{'loss': 0.7654, 'grad_norm': 1.1427799463272095, 'learning_rate': 4.36965811965812e-05, 'epoch': 2.13}
{'loss': 0.7139, 'grad_norm': 1.0377306938171387, 'learning_rate': 4.357787274453941e-05, 'epoch': 2.15}
{'loss': 0.7109, 'grad_norm': 1.2717130184173584, 'learning_rate': 4.345916429249763e-05, 'epoch': 2.17}
{'loss': 0.6946, 'grad_norm': 1.1547704935073853, 'learning_rate': 4.334045584045584e-05, 'epoch': 2.2}
{'loss': 0.7058, 'grad_norm': 1.1274946928024292, 'learning_rate': 4.3221747388414055e-05, 'epoch': 2.22}
{'loss': 0.7214, 'grad_norm': 1.1216835975646973, 'learning_rate': 4.310303893637227e-05, 'epoch': 2.24}
{'loss': 0.6729, 'grad_norm': 1.217260718345642, 'learning_rate': 4.298433048433049e-05, 'epoch': 2.26}
{'loss': 0.6859, 'grad_norm': 1.1477205753326416, 'learning_rate': 4.28656220322887e-05, 'epoch': 2.28}
{'loss': 0.692, 'grad_norm': 1.2387810945510864, 'learning_rate': 4.2746913580246915e-05, 'epoch': 2.3}
{'loss': 0.6532, 'grad_norm': 1.119612455368042, 'learning_rate': 4.262820512820513e-05, 'epoch': 2.32}
{'loss': 0.659, 'grad_norm': 0.981627345085144, 'learning_rate': 4.250949667616335e-05, 'epoch': 2.35}
{'loss': 0.6557, 'grad_norm': 1.2529133558273315, 'learning_rate': 4.239078822412156e-05, 'epoch': 2.37}
{'loss': 0.6757, 'grad_norm': 1.399604320526123, 'learning_rate': 4.2272079772079775e-05, 'epoch': 2.39}
{'loss': 0.6545, 'grad_norm': 1.0733332633972168, 'learning_rate': 4.2153371320037985e-05, 'epoch': 2.41}
{'loss': 0.6222, 'grad_norm': 1.1825895309448242, 'learning_rate': 4.203466286799621e-05, 'epoch': 2.43}
{'loss': 0.6133, 'grad_norm': 1.0425140857696533, 'learning_rate': 4.191595441595442e-05, 'epoch': 2.45}
{'loss': 0.6264, 'grad_norm': 1.1007411479949951, 'learning_rate': 4.1797245963912635e-05, 'epoch': 2.47}
{'loss': 0.6085, 'grad_norm': 1.4126616716384888, 'learning_rate': 4.1678537511870845e-05, 'epoch': 2.49}
{'loss': 0.6268, 'grad_norm': 1.194070816040039, 'learning_rate': 4.155982905982906e-05, 'epoch': 2.52}
{'loss': 0.5975, 'grad_norm': 1.5176697969436646, 'learning_rate': 4.144112060778728e-05, 'epoch': 2.54}
{'loss': 0.6159, 'grad_norm': 0.9663780927658081, 'learning_rate': 4.1322412155745495e-05, 'epoch': 2.56}
{'loss': 0.6158, 'grad_norm': 0.7453608512878418, 'learning_rate': 4.1203703703703705e-05, 'epoch': 2.58}
{'loss': 0.5858, 'grad_norm': 1.0832195281982422, 'learning_rate': 4.108499525166192e-05, 'epoch': 2.6}
{'loss': 0.5803, 'grad_norm': 0.8928701877593994, 'learning_rate': 4.096628679962013e-05, 'epoch': 2.62}
{'loss': 0.5849, 'grad_norm': 1.1012605428695679, 'learning_rate': 4.084757834757835e-05, 'epoch': 2.64}
{'loss': 0.6075, 'grad_norm': 0.9148216843605042, 'learning_rate': 4.0728869895536565e-05, 'epoch': 2.67}
{'loss': 0.576, 'grad_norm': 1.3182744979858398, 'learning_rate': 4.0610161443494775e-05, 'epoch': 2.69}
{'loss': 0.5902, 'grad_norm': 0.9025000929832458, 'learning_rate': 4.049145299145299e-05, 'epoch': 2.71}
{'loss': 0.5827, 'grad_norm': 0.9348947405815125, 'learning_rate': 4.037274453941121e-05, 'epoch': 2.73}
{'loss': 0.5945, 'grad_norm': 1.1154388189315796, 'learning_rate': 4.0254036087369425e-05, 'epoch': 2.75}
{'loss': 0.558, 'grad_norm': 1.046087384223938, 'learning_rate': 4.0135327635327635e-05, 'epoch': 2.77}
{'loss': 0.5482, 'grad_norm': 0.9402662515640259, 'learning_rate': 4.001661918328585e-05, 'epoch': 2.79}
{'loss': 0.5711, 'grad_norm': 1.140434980392456, 'learning_rate': 3.989791073124406e-05, 'epoch': 2.81}
{'loss': 0.5708, 'grad_norm': 0.8425564765930176, 'learning_rate': 3.9779202279202286e-05, 'epoch': 2.84}
{'loss': 0.5352, 'grad_norm': 1.0349311828613281, 'learning_rate': 3.9660493827160496e-05, 'epoch': 2.86}
{'loss': 0.5628, 'grad_norm': 0.9254890084266663, 'learning_rate': 3.954178537511871e-05, 'epoch': 2.88}
{'loss': 0.527, 'grad_norm': 0.9755590558052063, 'learning_rate': 3.942307692307692e-05, 'epoch': 2.9}
{'loss': 0.5422, 'grad_norm': 1.0090153217315674, 'learning_rate': 3.930436847103514e-05, 'epoch': 2.92}
{'loss': 0.5729, 'grad_norm': 0.7144617438316345, 'learning_rate': 3.9185660018993356e-05, 'epoch': 2.94}
{'loss': 0.5159, 'grad_norm': 1.0008083581924438, 'learning_rate': 3.906695156695157e-05, 'epoch': 2.96}
{'loss': 0.5447, 'grad_norm': 0.8481591939926147, 'learning_rate': 3.894824311490978e-05, 'epoch': 2.99}
===== Validation Example ===============
sample 1685
answer: 6
pred: 6

sample 769
answer: 6
pred: 6

sample 6949
answer: 2
pred: 2

sample 2433
answer: 2
pred: 2

sample 5311
answer: 9
pred: 9

=======================================
{'eval_loss': 0.506126344203949, 'eval_accuracy': 0.8827, 'eval_f1_score': 0.8808550240863285, 'eval_precision': 0.882811692104271, 'eval_recall': 0.880642529767249, 'eval_runtime': 1.9833, 'eval_samples_per_second': 5042.216, 'eval_steps_per_second': 157.821, 'epoch': 3.0}
{'loss': 0.4975, 'grad_norm': 0.8092398643493652, 'learning_rate': 3.8829534662868e-05, 'epoch': 3.01}
{'loss': 0.5299, 'grad_norm': 1.1299190521240234, 'learning_rate': 3.871082621082621e-05, 'epoch': 3.03}
{'loss': 0.5073, 'grad_norm': 0.9737796783447266, 'learning_rate': 3.859211775878443e-05, 'epoch': 3.05}
{'loss': 0.5072, 'grad_norm': 0.8211628198623657, 'learning_rate': 3.847340930674264e-05, 'epoch': 3.07}
{'loss': 0.5168, 'grad_norm': 0.9887213110923767, 'learning_rate': 3.835470085470086e-05, 'epoch': 3.09}
{'loss': 0.4865, 'grad_norm': 1.020085096359253, 'learning_rate': 3.823599240265907e-05, 'epoch': 3.11}
{'loss': 0.5239, 'grad_norm': 0.7597294449806213, 'learning_rate': 3.8117283950617286e-05, 'epoch': 3.13}
{'loss': 0.5047, 'grad_norm': 0.6621612906455994, 'learning_rate': 3.79985754985755e-05, 'epoch': 3.16}
{'loss': 0.4993, 'grad_norm': 0.7305256724357605, 'learning_rate': 3.787986704653371e-05, 'epoch': 3.18}
{'loss': 0.5337, 'grad_norm': 1.011972427368164, 'learning_rate': 3.776115859449193e-05, 'epoch': 3.2}
{'loss': 0.4918, 'grad_norm': 1.2154474258422852, 'learning_rate': 3.764245014245014e-05, 'epoch': 3.22}
{'loss': 0.5095, 'grad_norm': 1.0783236026763916, 'learning_rate': 3.7523741690408356e-05, 'epoch': 3.24}
{'loss': 0.4784, 'grad_norm': 0.8927609920501709, 'learning_rate': 3.740503323836657e-05, 'epoch': 3.26}
{'loss': 0.4917, 'grad_norm': 0.7621049284934998, 'learning_rate': 3.728632478632479e-05, 'epoch': 3.28}
{'loss': 0.454, 'grad_norm': 0.6977066397666931, 'learning_rate': 3.7167616334283e-05, 'epoch': 3.31}
{'loss': 0.4953, 'grad_norm': 0.9295641183853149, 'learning_rate': 3.7048907882241216e-05, 'epoch': 3.33}
{'loss': 0.47, 'grad_norm': 0.626863420009613, 'learning_rate': 3.693019943019943e-05, 'epoch': 3.35}
{'loss': 0.487, 'grad_norm': 1.0282562971115112, 'learning_rate': 3.681149097815765e-05, 'epoch': 3.37}
{'loss': 0.523, 'grad_norm': 0.975287139415741, 'learning_rate': 3.669278252611586e-05, 'epoch': 3.39}
{'loss': 0.4984, 'grad_norm': 0.7598887085914612, 'learning_rate': 3.6574074074074076e-05, 'epoch': 3.41}
{'loss': 0.51, 'grad_norm': 1.0639044046401978, 'learning_rate': 3.6455365622032286e-05, 'epoch': 3.43}
{'loss': 0.4659, 'grad_norm': 0.8361542820930481, 'learning_rate': 3.633665716999051e-05, 'epoch': 3.45}
{'loss': 0.4497, 'grad_norm': 0.9574325680732727, 'learning_rate': 3.621794871794872e-05, 'epoch': 3.48}
{'loss': 0.4986, 'grad_norm': 1.271904468536377, 'learning_rate': 3.6099240265906937e-05, 'epoch': 3.5}
{'loss': 0.4643, 'grad_norm': 0.8988763689994812, 'learning_rate': 3.5980531813865147e-05, 'epoch': 3.52}
{'loss': 0.4659, 'grad_norm': 0.6229794025421143, 'learning_rate': 3.586182336182336e-05, 'epoch': 3.54}
{'loss': 0.4529, 'grad_norm': 0.7418375015258789, 'learning_rate': 3.574311490978158e-05, 'epoch': 3.56}
{'loss': 0.4897, 'grad_norm': 0.711691677570343, 'learning_rate': 3.56244064577398e-05, 'epoch': 3.58}
{'loss': 0.475, 'grad_norm': 0.7788354754447937, 'learning_rate': 3.550569800569801e-05, 'epoch': 3.6}
{'loss': 0.4686, 'grad_norm': 0.8333151936531067, 'learning_rate': 3.5386989553656223e-05, 'epoch': 3.63}
{'loss': 0.4721, 'grad_norm': 0.8345990777015686, 'learning_rate': 3.526828110161443e-05, 'epoch': 3.65}
{'loss': 0.4502, 'grad_norm': 0.9632213711738586, 'learning_rate': 3.514957264957265e-05, 'epoch': 3.67}
{'loss': 0.4429, 'grad_norm': 0.8993704319000244, 'learning_rate': 3.503086419753087e-05, 'epoch': 3.69}
{'loss': 0.4463, 'grad_norm': 0.873284637928009, 'learning_rate': 3.491215574548908e-05, 'epoch': 3.71}
{'loss': 0.4729, 'grad_norm': 1.0056856870651245, 'learning_rate': 3.4793447293447294e-05, 'epoch': 3.73}
{'loss': 0.4427, 'grad_norm': 0.7585296034812927, 'learning_rate': 3.467473884140551e-05, 'epoch': 3.75}
{'loss': 0.4524, 'grad_norm': 0.8967134356498718, 'learning_rate': 3.455603038936373e-05, 'epoch': 3.77}
{'loss': 0.4572, 'grad_norm': 0.5687148571014404, 'learning_rate': 3.443732193732194e-05, 'epoch': 3.8}
{'loss': 0.4509, 'grad_norm': 0.816423237323761, 'learning_rate': 3.4318613485280154e-05, 'epoch': 3.82}
{'loss': 0.4115, 'grad_norm': 0.7904890775680542, 'learning_rate': 3.4199905033238364e-05, 'epoch': 3.84}
{'loss': 0.4466, 'grad_norm': 0.8785821199417114, 'learning_rate': 3.408119658119659e-05, 'epoch': 3.86}
{'loss': 0.4242, 'grad_norm': 0.7837926149368286, 'learning_rate': 3.39624881291548e-05, 'epoch': 3.88}
{'loss': 0.4577, 'grad_norm': 0.817035436630249, 'learning_rate': 3.3843779677113014e-05, 'epoch': 3.9}
{'loss': 0.4462, 'grad_norm': 0.9909709692001343, 'learning_rate': 3.3725071225071224e-05, 'epoch': 3.92}
{'loss': 0.4261, 'grad_norm': 0.9778358340263367, 'learning_rate': 3.360636277302944e-05, 'epoch': 3.95}
{'loss': 0.4539, 'grad_norm': 1.1642777919769287, 'learning_rate': 3.348765432098766e-05, 'epoch': 3.97}
{'loss': 0.4331, 'grad_norm': 0.8496293425559998, 'learning_rate': 3.3368945868945874e-05, 'epoch': 3.99}
===== Validation Example ===============
sample 5051
answer: 0
pred: 0

sample 6420
answer: 9
pred: 9

sample 1184
answer: 2
pred: 2

sample 4555
answer: 9
pred: 9

sample 3385
answer: 9
pred: 9

=======================================
{'eval_loss': 0.41840821504592896, 'eval_accuracy': 0.8953, 'eval_f1_score': 0.8939806829213897, 'eval_precision': 0.894767752582721, 'eval_recall': 0.8938889645710801, 'eval_runtime': 1.7889, 'eval_samples_per_second': 5590.093, 'eval_steps_per_second': 174.97, 'epoch': 4.0}
{'loss': 0.4419, 'grad_norm': 0.800209641456604, 'learning_rate': 3.3250237416904084e-05, 'epoch': 4.01}
{'loss': 0.4785, 'grad_norm': 0.8053871989250183, 'learning_rate': 3.31315289648623e-05, 'epoch': 4.03}
    main(args)
  File "/Users/mingu/Desktop/CODING/brAIn/2th/brAIn_2th_Torch_Session/week3/train.py", line 72, in main
    trainer.train()
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/transformers/trainer.py", line 2514, in _inner_training_loop
    batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches, args.device)
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/transformers/trainer.py", line 5243, in get_batch_samples
    batch_samples.append(next(epoch_iterator))
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/accelerate/data_loader.py", line 577, in __iter__
    next_batch = next(dataloader_iter)
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/Users/mingu/Desktop/CODING/brAIn/2th/brAIn_2th_Torch_Session/week3/src/dataset/data_collator.py", line 13, in __call__
    label = [torch.tensor(feature["label"]) for feature in features]
  File "/Users/mingu/Desktop/CODING/brAIn/2th/brAIn_2th_Torch_Session/week3/src/dataset/data_collator.py", line 13, in <listcomp>
    label = [torch.tensor(feature["label"]) for feature in features]
KeyboardInterrupt
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x1677848b0>
Traceback (most recent call last):
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 94, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 226, in teardown
    self._router.join()
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/Users/mingu/miniforge3/envs/brain/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt:
